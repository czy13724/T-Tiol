# å°†èŠ‚ç‚¹æ± è®¢é˜…é“¾æ¥åç§°æ ¼å¼åŒ–
# ä½œè€…ï¼šLevi
# å¼ºè¿«ç—‡ä¸“å±
# ä½¿ç”¨æ–¹æ³•ï¼šæ­é…rename-subs.pyä½¿ç”¨ã€‚é»˜è®¤ç”Ÿæˆæ–‡ä»¶å­˜æ”¾åœ¨ä»“åº“æ ¹ç›®å½•ï¼Œåˆå§‹é“¾æ¥å…¨éƒ¨æ”¾åœ¨stored-subs.txté‡Œå³å¯ï¼Œç”Ÿæˆçš„æ–‡ä»¶ä¸ºupgrade-subs.txtã€‚
name: rename-subs

on:
  workflow_dispatch:
  
jobs:
  normalize:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Setup Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.x'

      - name: Install dependencies
        run: |
          pip install --upgrade pip
          pip install requests geopy

      - name: Run rename-subs
        run: python .github/py/rename-subs.py


      - name: Commit & Push
        run: |
          git config --global user.name  "GitHub Actions"
          git config --global user.email "actions@github.com"
          git add upgrade-subs.txt
          if ! git diff --cached --quiet; then
            git commit -m "ğŸ”„ update upgrade-subs.txt âœ” - $(TZ='Asia/Shanghai' date '+%Y-%m-%d %H:%M:%S')"
            git pull --rebase origin main
            git push
          else
            echo "No changes to commit"
          fi
